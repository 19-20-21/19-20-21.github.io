


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.3">
    
    
      
        <title>13.7 局部模板特化 - LearnCPP 中文教程</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.947af8d5.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#137" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="LearnCPP 中文教程" class="md-header-nav__button md-logo" aria-label="LearnCPP 中文教程">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            LearnCPP 中文教程
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              13.7 局部模板特化
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LearnCPP 中文教程" class="md-nav__button md-logo" aria-label="LearnCPP 中文教程">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LearnCPP 中文教程
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="目录" class="md-nav__link">
      目录
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      0 Introduction getting started
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="0 Introduction getting started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        0 Introduction getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../0-Introduction-getting-started/" title="第零章 介绍/起步" class="md-nav__link">
      第零章 介绍/起步
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../0-Introduction-getting-started/0.1-Introduction-to-these-tutorials/" title="0.1 教程介绍" class="md-nav__link">
      0.1 教程介绍
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      12 virtual functions
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="12 virtual functions" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        12 virtual functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../12-virtual-functions/" title="第十二章 虚函数" class="md-nav__link">
      第十二章 虚函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../12-virtual-functions/12.7-virtual-base-classes/" title="12.7 虚基类 (Virtual base classes)" class="md-nav__link">
      12.7 虚基类 (Virtual base classes)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../12-virtual-functions/12.8-object-slicing/" title="12.8 对象切割" class="md-nav__link">
      12.8 对象切割
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../12-virtual-functions/12.9-dynamic-casting/" title="12.9动态类型转换" class="md-nav__link">
      12.9动态类型转换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../12-virtual-functions/12.x%20chapter-12-comprehensice-quiz/" title="12.x 十二章理解和练习" class="md-nav__link">
      12.x 十二章理解和练习
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      13 templates
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="13 templates" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        13 templates
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="十三章 模板" class="md-nav__link">
      十三章 模板
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.1-function-templates/" title="13.1 函数模板 Function templates" class="md-nav__link">
      13.1 函数模板 Function templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.2-function-template-instances/" title="13.2 函数模板的实例化" class="md-nav__link">
      13.2 函数模板的实例化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.3-template-classes/" title="13.3 模板类" class="md-nav__link">
      13.3 模板类
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.4-template-non-type-parameters/" title="13.4 模板非类型参数" class="md-nav__link">
      13.4 模板非类型参数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.5-function-template-specialization/" title="13.5 函数模板特化" class="md-nav__link">
      13.5 函数模板特化
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="13.7 局部模板特化" class="md-nav__link md-nav__link--active">
      13.7 局部模板特化
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.8-partial-template-specialization-for-pointers/" title="13.8 指针的局部模板特化" class="md-nav__link">
      13.8 指针的局部模板特化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.x%20chapter-13-comprehensice-quiz/" title="13.x 十三章理解和练习" class="md-nav__link">
      13.x 十三章理解和练习
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      14 exceptions
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="14 exceptions" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        14 exceptions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/" title="14 异常" class="md-nav__link">
      14 异常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.1-the-need-for-exceptions/" title="14.1 为什么需要异常" class="md-nav__link">
      14.1 为什么需要异常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.2-basic-exception-handloing/" title="14.2 基本异常处理" class="md-nav__link">
      14.2 基本异常处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.3-exceptions-functions-and-stack-unwinding/" title="14.3 异常，函数，栈展开" class="md-nav__link">
      14.3 异常，函数，栈展开
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.4-uncaught-exceptions-catch-all-handlers-and-exception-specifiers/" title="14.4 未捕获异常，捕获全部异常和异常说明符" class="md-nav__link">
      14.4 未捕获异常，捕获全部异常和异常说明符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.5-exceptions-classes-and-inheritance/" title="14.5 异常，类和继承" class="md-nav__link">
      14.5 异常，类和继承
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.6-rethrowing-exceptions/" title="14.6 异常的再抛出" class="md-nav__link">
      14.6 异常的再抛出
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.7-function-try-blocks/" title="14.7 函数级的 try 代码块" class="md-nav__link">
      14.7 函数级的 try 代码块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../14-exceptions/14.8-exception-dangers-and-downsides/" title="14.8 异常的危险和缺点" class="md-nav__link">
      14.8 异常的危险和缺点
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      15 move semantics and smart pointers
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="15 move semantics and smart pointers" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        15 move semantics and smart pointers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/" title="15 移动语义和智能指针" class="md-nav__link">
      15 移动语义和智能指针
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.1-intro-to-smart-pointers-and-move-semantics/" title="15.1 智能指针和移动语义的介绍" class="md-nav__link">
      15.1 智能指针和移动语义的介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.2-r-value-reference/" title="15.2 右值引用" class="md-nav__link">
      15.2 右值引用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.3-move-constructors-and-move-assignment/" title="15.3 移动构造和移动赋值" class="md-nav__link">
      15.3 移动构造和移动赋值
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.4-std%3A%3Amove/" title="15.4 std::move" class="md-nav__link">
      15.4 std::move
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.5-std%3A%3Aunique_ptr/" title="15.5 std::unique_ptr" class="md-nav__link">
      15.5 std::unique_ptr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.6-std%3A%3Ashared_ptr/" title="15.6 std::shared_ptr" class="md-nav__link">
      15.6 std::shared_ptr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../15-move-semantics-and-smart-pointers/15.7-std%3A%3Aweak_ptr/" title="15.7 std::shared_ptr 的循环依赖问题，介绍 std::weak_ptr" class="md-nav__link">
      15.7 std::shared_ptr 的循环依赖问题，介绍 std::weak_ptr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      18 input and output
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="18 input and output" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        18 input and output
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../18-input-and-output/18.1-input-and-output-streams/" title="18.1 - 输入输出流" class="md-nav__link">
      18.1 - 输入输出流
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="137">13.7 局部模板特化<a class="headerlink" href="#137" title="Permanent link">&para;</a></h1>
<!-- 13.7 — Partial template specialization -->

<p>By Alex on August 17<sup>th</sup>, 2008 | last modified by nascardriver on March 28<sup>th</sup>, 2020</p>
<p>This lesson and the next are optional reading for those desiring a deeper knowledge of C++ templates. Partial template specialization is not used all that often (but can be useful in specific cases).</p>
<p>In lesson 13.4 -- Template non-type parameters, you learned how expression parameters could be used to parameterize template classes.</p>
<p>Let’s take another look at the Static Array class we used in one of our previous examples:</p>
<div class="highlight"><pre><span></span><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
    <span class="c1">// The expression parameter controls the size of the array</span>
    <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

    <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<p>This class takes two template parameters, a type parameter, and an expression parameter.</p>
<p>Now, let’s say we wanted to write a function to print out the whole array. Although we could implement this as a member function, we’re going to do it as a non-member function instead because it will make the successive examples easier to follow.</p>
<p>Using templates, we might write something like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>This would allow us to do the following:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
 <span class="c1">// declare an int array</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">int4</span><span class="p">{};</span>
 <span class="n">int4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="n">int4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="n">int4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
 <span class="n">int4</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

 <span class="c1">// Print the array</span>
 <span class="n">print</span><span class="p">(</span><span class="n">int4</span><span class="p">);</span>

 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>and get the following result:</p>
<p>0 1 2 3</p>
<p>Although this works, it has a design flaw. Consider the following:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// declare a char array</span>
    <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">14</span><span class="o">&gt;</span> <span class="n">char14</span><span class="p">{};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">char14</span><span class="p">.</span><span class="n">getArray</span><span class="p">(),</span> <span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>

    <span class="c1">// Print the array</span>
    <span class="n">print</span><span class="p">(</span><span class="n">char14</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>(We covered std::strcpy in lesson 6.6 -- C-style strings if you need a refresher)</p>
<p>This program will compile, execute, and produce the following value (or one similar):</p>
<p>H e l l o ,   w o r l d !</p>
<p>For non-char types, it makes sense to put a space between each array element, so they don’t run together. However, with a char type, it makes more sense to print everything run together as a C-style string, which our print() function doesn’t do.</p>
<p>So how can we fix this?</p>
<p>Template specialization to the rescue?</p>
<p>One might first think of using template specialization. The problem with full template specialization is that all template parameters must be explicitly defined.</p>
<p>Consider:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Override print() for fully specialized StaticArray&lt;char, 14&gt;</span>
<span class="k">template</span> <span class="o">&lt;&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">14</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// declare a char array</span>
    <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">14</span><span class="o">&gt;</span> <span class="n">char14</span><span class="p">{};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">char14</span><span class="p">.</span><span class="n">getArray</span><span class="p">(),</span> <span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>

    <span class="c1">// Print the array</span>
    <span class="n">print</span><span class="p">(</span><span class="n">char14</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>As you can see, we’ve now provided an overloaded print function for fully specialized StaticArray<char, 14>. Indeed, this prints:</p>
<p>Hello, world!</p>
<p>Although this solves the issue of making sure print() can be called with a StaticArray<char, 14>, it brings up another problem: using full template specialization means we have to explicitly define the length of the array this function will accept! Consider the following example:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// declare a char array</span>
    <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">12</span><span class="o">&gt;</span> <span class="n">char12</span><span class="p">{};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">char12</span><span class="p">.</span><span class="n">getArray</span><span class="p">(),</span> <span class="s">&quot;Hello, mom!&quot;</span><span class="p">);</span>

    <span class="c1">// Print the array</span>
    <span class="n">print</span><span class="p">(</span><span class="n">char12</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Calling print() with char12 will call the version of print() that takes a StaticArray<T, size>, because char12 is of type StaticArray<char, 12>, and our overloaded print() will only be called when passed a StaticArray<char, 14>.</p>
<p>Although we could make a copy of print() that handles StaticArray<char, 12>, what happens when we want to call print() with an array size of 5, or 22? We’d have to copy the function for each different array size. That’s redundant.</p>
<p>Obviously full template specialization is too restrictive a solution here. The solution we are looking for is partial template specialization.</p>
<p>Partial template specialization</p>
<p>Partial template specialization allows us to specialize classes (but not individual functions!) where some, but not all, of the template parameters have been explicitly defined. For our challenge above, the ideal solution would be to have our overloaded print function work with StaticArray of type char, but leave the length expression parameter templated so it can vary as needed. Partial template specialization allows us to do just that!</p>
<p>Here’s our example with an overloaded print function that takes a partially specialized StaticArray:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// overload of print() function for partially specialized StaticArray&lt;char, size&gt;</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is still a templated expression parameter</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span> <span class="c1">// we&#39;re explicitly defining type char here</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>

<p>As you can see here, we’ve explicitly declared that this function will only work for StaticArray of type char, but size is still a templated expression parameter, so it will work for char arrays of any size. That’s all there is to it!</p>
<p>Here’s a full program using this:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// overload of print() function for partially specialized StaticArray&lt;char, size&gt;</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">array</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
 <span class="c1">// Declare an char array of size 14</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">14</span><span class="o">&gt;</span> <span class="n">char14</span><span class="p">{};</span>

 <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">char14</span><span class="p">.</span><span class="n">getArray</span><span class="p">(),</span> <span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>

 <span class="c1">// Print the array</span>
 <span class="n">print</span><span class="p">(</span><span class="n">char14</span><span class="p">);</span>

 <span class="c1">// Now declare an char array of size 12</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">12</span><span class="o">&gt;</span> <span class="n">char12</span><span class="p">{};</span>

 <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">char12</span><span class="p">.</span><span class="n">getArray</span><span class="p">(),</span> <span class="s">&quot;Hello, mom!&quot;</span><span class="p">);</span>

 <span class="c1">// Print the array</span>
 <span class="n">print</span><span class="p">(</span><span class="n">char12</span><span class="p">);</span>

 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>This prints:</p>
<p>Hello, world! Hello, mom!</p>
<p>Just as we expect.</p>
<p>Note that as of C++14, partial template specialization can only be used with classes, not template functions (functions must be fully specialized). Our void print(StaticArray<char, size> &amp;array) example works because the print function is not partially specialized (it’s just an overloaded function using a class parameter that’s partially specialized).</p>
<p>Partial template specialization for member functions</p>
<p>The limitation on the partial specialization of functions can lead to some challenges when dealing with member functions. For example, what if we had defined StaticArray like this?</p>
<div class="highlight"><pre><span></span><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
    <span class="c1">// The expression parameter controls the size of the array</span>
    <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

    <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">print</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<p>print() is now a member function of class StaticArray<T, int>. So what happens when we want to partially specialize print(), so that it works differently? You might try this:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Doesn&#39;t work</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;::</span><span class="n">print</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">scientific</span> <span class="o">&lt;&lt;</span> <span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
 <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Unfortunately, this doesn’t work, because we’re trying to partially specialize a function, which is disallowed.</p>
<p>So how do we get around this? One obvious way is to partially specialize the entire class:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
 <span class="kt">void</span> <span class="n">print</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">};</span>


<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="kt">double</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="kt">double</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="kt">double</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
 <span class="kt">void</span> <span class="n">print</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">scientific</span> <span class="o">&lt;&lt;</span> <span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
 <span class="c1">// declare an integer array with room for 6 integers</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">6</span><span class="o">&gt;</span> <span class="n">intArray</span><span class="p">{};</span>

 <span class="c1">// Fill it up in order, then print it</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">intArray</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>

 <span class="n">intArray</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

 <span class="c1">// declare a double buffer with room for 4 doubles</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">doubleArray</span><span class="p">{};</span>

 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">doubleArray</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">count</span><span class="p">);</span>

 <span class="n">doubleArray</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>This prints:</p>
<p>0 1 2 3 4 5
4.000000e+00 4.100000e+00 4.200000e+00 4.300000e+00</p>
<p>While it works, this isn’t a great solution, because we had to duplicate a lot of code from StaticArray<T, size> to StaticArray<double, size>.</p>
<p>If only there were some way to reuse the code in StaticArray<T, size> in StaticArray<double, size>. Sounds like a job for inheritance!</p>
<p>You might start off trying to write that code like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;:</span> <span class="k">public</span> <span class="n">StaticArray</span><span class="o">&lt;</span> <span class="c1">// Then what?</span>
</code></pre></div>

<p>How do we reference StaticArray? We can’t.</p>
<p>Fortunately, there’s a workaround, by using a common base class:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray_Base</span>
<span class="p">{</span>
<span class="k">protected</span><span class="o">:</span>
 <span class="c1">// The expression parameter controls the size of the array</span>
 <span class="n">T</span> <span class="n">m_array</span><span class="p">[</span><span class="n">size</span><span class="p">]{};</span>

<span class="k">public</span><span class="o">:</span>
 <span class="n">T</span><span class="o">*</span> <span class="n">getArray</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_array</span><span class="p">;</span> <span class="p">}</span>

 <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">m_array</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
 <span class="p">}</span>
 <span class="k">virtual</span> <span class="kt">void</span> <span class="n">print</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">virtual</span> <span class="o">~</span><span class="n">StaticArray_Base</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span><span class="o">:</span> <span class="k">public</span> <span class="n">StaticArray_Base</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">size</span><span class="o">&gt;</span> <span class="c1">// size is the expression parameter</span>
<span class="k">class</span> <span class="nc">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;:</span> <span class="k">public</span> <span class="n">StaticArray_Base</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="n">size</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>

 <span class="k">virtual</span> <span class="kt">void</span> <span class="n">print</span><span class="p">()</span> <span class="k">override</span>
 <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">scientific</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">m_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="c1">// note: The this-&gt; prefix in the above line is needed.</span>
<span class="c1">// See https://stackoverflow.com/a/6592617 or https://isocpp.org/wiki/faq/templates#nondependent-name-lookup-members for more info on why.</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
 <span class="c1">// declare an integer array with room for 6 integers</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">6</span><span class="o">&gt;</span> <span class="n">intArray</span><span class="p">{};</span>

 <span class="c1">// Fill it up in order, then print it</span>
 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">intArray</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>

 <span class="n">intArray</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

 <span class="c1">// declare a double buffer with room for 4 doubles</span>
 <span class="n">StaticArray</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">doubleArray</span><span class="p">{};</span>

 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">count</span><span class="p">)</span>
  <span class="n">doubleArray</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">count</span><span class="p">);</span>

 <span class="n">doubleArray</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>This prints the same as above, but has significantly less duplicated code.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../13.5-function-template-specialization/" title="13.5 函数模板特化" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                13.5 函数模板特化
              </div>
            </div>
          </a>
        
        
          <a href="../13.8-partial-template-specialization-for-pointers/" title="13.8 指针的局部模板特化" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                13.8 指针的局部模板特化
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.c3dc8c49.min.js"></script>
      <script src="../../assets/javascripts/bundle.f9edbbd5.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8e2cddea.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>